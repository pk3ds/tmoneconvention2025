import{r as g,f as s,g as o,l as x,u as S,k as b,F as p,p as t,x as r,y as m,C as y,G as B,v as C,z as O,H as j,q as N}from"./@vue-r-HUGdoc.js";import{Q as D,Z as F,O as M}from"./@inertiajs-ssfLaM5f.js";import{_ as P}from"./AuthenticatedLayout-7zCDPPUQ.js";import{P as q}from"./PrimaryButton-Bi0o4Yet.js";import"./axios-mNEckKTA.js";import"./deepmerge-LjH1GvcH.js";import"./call-bind-C9g98eDj.js";import"./get-intrinsic-PI8GGpBQ.js";import"./has-symbols-fNtejGuA.js";import"./has-proto-dzJH2Y5C.js";import"./function-bind-HMk2skFd.js";import"./hasown-iNtpzeJm.js";import"./set-function-length-Q9qN-rEI.js";import"./define-data-property-0n4USnm6.js";import"./has-property-descriptors-CncpgOAI.js";import"./gopd-l1hRYync.js";import"./qs-NiufHlhl.js";import"./side-channel-DQESS8qD.js";import"./object-inspect-upD72wnW.js";import"./nprogress-eK4H2Raz.js";import"./lodash.clonedeep-ONeKF3hD.js";import"./lodash.isequal-8drsGctg.js";import"./flowbite-0yPYSvbH.js";import"./@popperjs-zyV4rJhQ.js";import"./_plugin-vue_export-helper-x3n3nnut.js";const z={class:"py-12"},E={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},L={class:"bg-white shadow-sm sm:rounded-lg"},R={class:"p-6"},T={class:"mb-6"},$={class:"text-2xl font-bold text-gray-900"},G={key:0,class:"mt-2 text-gray-600"},H={key:1,class:"mt-2 text-sm text-gray-500"},Q={key:0,class:"space-y-4"},U=t("h2",{class:"text-lg font-semibold mb-4"},"Results",-1),Y={class:"flex justify-between text-sm text-gray-600"},Z={class:"relative w-full h-4 bg-gray-200 rounded-full overflow-hidden"},A={class:"flex justify-between items-center"},I={class:"text-sm text-gray-500"},J={key:0,class:"mt-2"},K={key:0,class:"pl-4 border-l-2 border-gray-200"},W=t("p",{class:"text-sm font-medium text-gray-700 mb-1"}," Voters: ",-1),X={class:"space-y-1"},tt=t("span",{class:"text-gray-400"},"|",-1),et={class:"text-gray-400"},st={class:"mt-4 text-sm text-gray-600"},ot=t("h2",{class:"text-lg font-semibold mb-4"}," Cast Your Vote ",-1),lt={class:"space-y-3"},it={class:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"},at=["value"],rt={class:"text-gray-900"},nt={class:"flex justify-end mt-6"},Pt={__name:"Show",props:{poll:{type:Object,required:!0}},setup(i){const d=i,w=D(),c=g(null),_=g(!1),V=()=>{var a;return((a=d.poll.votes)==null?void 0:a.some(e=>e.user_id===w.props.auth.user.id))??!1},f=a=>{var n;const e=((n=d.poll.votes)==null?void 0:n.length)||0;return e===0?0:Math.round(a/e*100)},h=a=>{var e;return((e=d.poll.votes)==null?void 0:e.filter(n=>n.poll_option_id===a).length)||0},v=a=>{var e;return((e=d.poll.votes)==null?void 0:e.filter(n=>n.poll_option_id===a))||[]},k=()=>{c.value&&(_.value=!0,M.post(route("polls.vote",d.poll.id),{option_id:c.value},{onFinish:()=>{_.value=!1}}))};return(a,e)=>(s(),o(p,null,[x(S(F),{title:i.poll.title},null,8,["title"]),x(P,null,{default:b(()=>{var n;return[t("div",z,[t("div",E,[t("div",L,[t("div",R,[t("div",T,[t("h1",$,r(i.poll.title),1),i.poll.description?(s(),o("p",G,r(i.poll.description),1)):m("",!0),i.poll.expires_at?(s(),o("p",H," Expires: "+r(new Date(i.poll.expires_at).toLocaleString()),1)):m("",!0)]),V()?(s(),o("div",Q,[U,(s(!0),o(p,null,y(i.poll.options,l=>(s(),o("div",{key:l.id,class:"space-y-2"},[t("div",Y,[t("span",null,r(l.option_text),1),t("span",null,r(f(h(l.id)))+"% ",1)]),t("div",Z,[t("div",{class:"absolute top-0 left-0 h-full bg-blue-600 transition-all duration-500",style:B({width:f(h(l.id))+"%"})},null,4)]),t("div",A,[t("p",I,r(h(l.id))+" votes ",1)]),a.$page.props.permissions.includes("manage surveys")?(s(),o("div",J,[v(l.id).length>0?(s(),o("div",K,[W,t("ul",X,[(s(!0),o(p,null,y(v(l.id),u=>(s(),o("li",{key:u.id,class:"text-sm text-gray-600 flex items-center space-x-2"},[t("span",null,r(u.user.name),1),tt,t("span",et,r(u.user.staff_id),1)]))),128))])])):m("",!0)])):m("",!0)]))),128)),t("div",st," Total votes: "+r(((n=i.poll.votes)==null?void 0:n.length)||0),1)])):(s(),o("form",{key:1,onSubmit:C(k,["prevent"]),class:"space-y-4"},[ot,t("div",lt,[(s(!0),o(p,null,y(i.poll.options,l=>(s(),o("div",{key:l.id},[t("label",it,[O(t("input",{type:"radio",value:l.id,"onUpdate:modelValue":e[0]||(e[0]=u=>c.value=u),name:"poll_option",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,8,at),[[j,c.value]]),t("span",rt,r(l.option_text),1)])]))),128))]),t("div",nt,[x(q,{disabled:!c.value||_.value},{default:b(()=>[N(" Submit Vote ")]),_:1},8,["disabled"])])],32))])])])])]}),_:1})],64))}};export{Pt as default};
